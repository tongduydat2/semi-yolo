# SSOD Configuration for Gray-to-IronRed Domain Adaptation
# All paths follow standard YOLO dataset format

# =============================================================================
# DATA PATHS (Customize these paths for your dataset)
# =============================================================================
data:
  # Labeled data (Gray images + annotations) - YOLO format
  labeled:
    images: "/mnt/d/ThucTap/Al_platform_Solar/datasets/Thermal PV Panel Detection Dataset for UAV Inspection/train/images"
    labels: "/mnt/d/ThucTap/Al_platform_Solar/datasets/Thermal PV Panel Detection Dataset for UAV Inspection/train/labels"
  
  # Unlabeled data (Real IronRed images) - No labels needed
  unlabeled:
    images: "/mnt/d/ThucTap/Al_platform_Solar/datasets/Thermal PV Panel Detection Dataset for UAV Inspection/test/images"
  
  # Fake IronRed output (Generated from colorization)
  fake_ironred:
    images: "/mnt/d/ThucTap/Al_platform_Solar/datasets/fake_ironred/images"
    labels: "/mnt/d/ThucTap/Al_platform_Solar/datasets/fake_ironred/labels"
  
  # Validation set
  val:
    images: "/mnt/d/ThucTap/Al_platform_Solar/datasets/Thermal PV Panel Detection Dataset for UAV Inspection/val/images"
    labels: "/mnt/d/ThucTap/Al_platform_Solar/datasets/Thermal PV Panel Detection Dataset for UAV Inspection/val/labels"
  
  # Output directory for checkpoints
  output_dir: "runs/ssod"
  
  # Skip colorization and use original labeled data directly
  # Set to true if you don't want to convert Gray to IronRed
  skip_colorization: true

# =============================================================================
# MODEL SETTINGS (Customize model architecture)
# =============================================================================
model:
  # Base YOLO model - can be: yolo11n.pt, yolo11s.pt, yolo11m.pt, yolo11l.pt, yolo11x.pt
  # Or path to custom pretrained weights
  base_model: "/mnt/d/ThucTap/Al_platform_Solar/models/model_08e69871-1766083200_best.pt"
  
  # Number of classes in your dataset
  num_classes: 1
  
  # Image size for training
  imgsz: 640
  
  # Class names (optional - will auto-generate if not defined)
  # Uncomment and modify for your dataset:
  # class_names:
  #   0: "hotspot"
  #   1: "crack"
  #   2: "diode_failure"
  #   3: "shading"
  #   4: "soiling"
  #   5: "delamination"
  #   6: "snail_trail"
  #   7: "normal"

# =============================================================================
# TRAINING PARAMETERS
# =============================================================================
training:
  max_epochs: 100
  burn_in_epochs: 15          # Epochs for supervised-only training
  batch_size: 16
  learning_rate: 0.001
  weight_decay: 0.0005
  warmup_epochs: 3
  
  # Optimizer: SGD, Adam, AdamW
  optimizer: "AdamW"
  
  # Scheduler: linear, cosine, constant
  scheduler: "cosine"

# =============================================================================
# SSOD PARAMETERS
# =============================================================================
ssod:
  # Confidence threshold for pseudo-labels (Tau)
  confidence_threshold: 0.75
  
  # Weight for unsupervised loss (Lambda)
  unsupervised_weight: 2.0
  
  # EMA decay rate for Teacher updates (Alpha)
  ema_rate: 0.999
  
  # Adaptive thresholding settings
  adaptive_threshold: true
  tau_min: 0.65
  tau_max: 0.80
  
  # NMS threshold for pseudo-labels
  nms_threshold: 0.5

# =============================================================================
# AUGMENTATION SETTINGS
# =============================================================================
augmentation:
  # Weak augmentation (for Teacher - keep clean)
  weak:
    resize: [640, 640]
    horizontal_flip: 0.5
  
  # Strong augmentation (for Student - make harder)
  strong:
    mosaic: true
    mosaic_prob: 0.5
    mixup: 0.3
    cutout: 0.3
    cutout_holes: 3
    cutout_ratio: 0.1
    gaussian_noise: 0.1
    color_jitter: true
    brightness: [0.8, 1.2]
    contrast: [0.8, 1.2]

# =============================================================================
# COLORIZATION LUT SETTINGS (Gray to IronRed conversion)
# =============================================================================
colorization:
  # Cold regions: Black to Dark Purple
  cold_range: [0, 60]
  cold_color_start: [0, 0, 0]        # RGB
  cold_color_end: [80, 0, 80]        # RGB
  
  # Warm regions: Purple to Orange-Red
  warm_range: [60, 150]
  warm_color_start: [80, 0, 80]      # RGB
  warm_color_end: [255, 100, 0]      # RGB
  
  # Hot regions: Orange to Yellow/White
  hot_range: [150, 255]
  hot_color_start: [255, 100, 0]     # RGB
  hot_color_end: [255, 255, 200]     # RGB

# =============================================================================
# EVALUATION SETTINGS
# =============================================================================
evaluation:
  # Save checkpoint every N epochs
  save_interval: 5
  
  # Run validation every N epochs
  val_interval: 1
  
  # Keep best N checkpoints
  keep_best: 3
  
  # Metrics to track
  metrics: ["mAP50", "mAP50-95", "precision", "recall"]

# =============================================================================
# LOGGING SETTINGS
# =============================================================================
logging:
  # Log every N steps
  log_interval: 10
  
  # Use TensorBoard
  tensorboard: true
  
  # Use Weights & Biases (optional)
  wandb: false
  wandb_project: "ssod-thermal"

# =============================================================================
# CLEANUP SETTINGS (Disk space management)
# =============================================================================
cleanup:
  # Enable automatic cleanup after each epoch
  enabled: true
  
  # Number of best checkpoints to keep (older ones will be deleted)
  keep_best_checkpoints: 3
  
  # Cleanup pseudo-labels after each epoch (they are regenerated anyway)
  cleanup_pseudo_labels: true
  
  # Cleanup YOLO training run directories (logs, temp weights)
  cleanup_training_runs: true
